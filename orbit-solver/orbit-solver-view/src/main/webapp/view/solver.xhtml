<ui:composition template="/WEB-INF/templates/root-template/root-template.xhtml"
                xmlns="http://www.w3.org/1999/xhtml"
                xmlns:f="http://java.sun.com/jsf/core"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:ui="http://java.sun.com/jsf/facelets"
                xmlns:p="http://primefaces.org/ui">
    <ui:define name="pageTitle">Orbit Solver Page</ui:define>


    <ui:define name="content">
        <h:outputScript library="js" name="orbitalSolver.js" target="head"></h:outputScript>
        <h:outputStylesheet library="css" name="solver-style.css"/>

        <p:toolbar>
            <f:facet name="left">
                <h:outputText value="Periodic Solutions Test" id="test-header"/>
                <span class="ui-separator">
                    <span class="ui-icon ui-icon-grip-dotted-vertical" />
                </span>
                <p:commandButton type="button" value="Test Solver" icon="ui-icon-plus" onclick="SolverPage.testSolver()"/>
            </f:facet>

            <f:facet name="right">
                <p:button id="home" value="Back" icon="fa fa-home" outcome="index.xhtml"/>
                <p:commandButton type="button" value="Settings" icon="ui-icon-gear" onclick="SolverPage.changeSettings()"/>
            </f:facet>
        </p:toolbar>

        <div id="display">
            <div id="message-section"></div>
            <div id='result-section'></div>
        </div>

        <script>
            var SolverPage = new Object();

            SolverPage.default_n_bodies = 3;
            SolverPage.default_fourier_precision = 5;
            SolverPage.default_time_precision = 10;

            SolverPage.testSolver = function () {
                var orbitalSolver = new OrbitalSolver(
                        SolverPage.default_n_bodies,
                        SolverPage.default_fourier_precision,
                        SolverPage.default_time_precision
                        );

                var jsonResult = orbitalSolver.solve();
                if (jsonResult.success) {
                    var jsonString = JSON.stringify(jsonResult);
                    jsonString = jsonString.replace(/,/g, "<br/>");
                    $("#message-section").removeClass("error");
                    $("#message-section").addClass("success");

                    $("#message-section").text("Found solution :: " + jsonResult.simulationId);
                    $("#result-section").html(jsonString);
                } else {
                    $("#message-section").removeClass("success");
                    $("#message-section").addClass("error");

                    var errMsg = jsonResult.errorMsg || "Unknown error";
                    $("#message-section").text("Error encountered :: " + errMsg);

                }
                $("#message-section").show();
                $("#message-section").animate({
                    opacity: 1
                }, 1500);
            };

            SolverPage.changeSettings = function () {

            };

            $(document).ready(function () {
                $("#message-section").hide();
            });

        </script>
    </ui:define>
</ui:composition>